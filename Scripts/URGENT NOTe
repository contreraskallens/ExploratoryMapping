note:problem with vector creation in lines 571-572. check if that distorted results. fuck.